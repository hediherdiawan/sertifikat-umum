<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Sertifikat Supervisi Akademik</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

<style>
@media print {
  body * { visibility: hidden; }
  #certificate, #certificate * { visibility: visible; }
  #certificate {
    position: absolute;
    left: 0;
    top: 0;
    width: 210mm;
    height: 297mm;
    margin: 0;
    box-shadow: none;
    border: none;
  }
  body { margin: 0; background: white; }
  @page { size: A4 portrait; margin: 0; }
}

body{
    background:#e9ecef;
    font-family:'Georgia', serif;
    text-align:center;
}

.input-area{ margin:20px; }

.certificate{
    width:794px;
    height:1122px;
    background:white;
    margin:20px auto;
    padding:80px 70px;
    box-sizing:border-box;
    border:14px solid #0f4c5c;
    position:relative;
    box-shadow:0 15px 30px rgba(0,0,0,0.25);
}

.logo{ width:120px; margin-bottom:15px; }

h1{
    font-size:44px;
    color:#00897b;
    letter-spacing:4px;
    margin:5px 0;
}

.nomor{ font-size:18px; margin-bottom:35px; }

.name{
    font-size:32px;
    font-weight:bold;
    color:#1a237e;
    margin:20px 0;
}

.school{ font-size:20px; margin-bottom:25px; }

.details{ font-size:18px; line-height:1.7; margin-top:20px; }

ul{
    list-style-type:square;
    width:70%;
    margin:25px auto;
    text-align:left;
    font-size:18px;
}

.signature{
    position:absolute;
    right:70px;
    bottom:150px;
    text-align:right;
}

.qr{ margin:12px 0; }

.bottom-left{
    position:absolute;
    left:30px;
    bottom:15px;
    text-align:left;
}

#kode-sertifikat{
    font-size:13px;
    font-weight:600;
    margin-bottom:4px;
}

.microtext{
    font-size:8px;
    letter-spacing:1px;
    opacity:0.4;
}

button{
    padding:10px 20px;
    background:#00897b;
    color:white;
    border:none;
    cursor:pointer;
}

button:hover{ background:#00695c; }
</style>
</head>
<body>

<div class="input-area">
<input type="text" id="namaInput" placeholder="Masukkan Nama Peserta">
<select id="sekolahInput">
<option value="">-- Pilih Sekolah --</option>
<option>SD N JANALA</option>
<option>SD N RUMPIN 01</option>
<option>SD N RUMPIN 02</option>
<option>SD NEGERI RUMPIN 03</option>
</select>
<button onclick="generateCertificate()">Buat Sertifikat</button>
</div>

<div id="certificate" class="certificate">

<img src="https://disdik.bogorkab.go.id/uploads/settings/17550565574906.png" class="logo">

<h1>SERTIFIKAT</h1>
<div class="nomor">No. 001/Kombel/II/2026</div>

<div>Diberikan kepada:</div>
<div class="name" id="namaPeserta">................................</div>
<div class="school" id="namaSekolah"></div>

<div class="details">
Sebagai peserta kegiatan Supervisi Akademik Gugus 1-4 dan berbagi praktik baik,
tahun ajaran 2025/2026, dengan durasi 8 JP.
</div>

<ul>
<li>Micro Teaching (4 JP)</li>
<li>Administrasi Pembelajaran (4 JP)</li>
</ul>

<div class="signature">
Rumpin, 13 Februari 2026<br><br>
Pengawas Pembina SD Kecamatan Rumpin
<div class="qr" id="qrcode"></div>
<b>Hedi Herdiawan, S.Pd., M.M.</b><br>
NIP.197808102010011008
</div>

<div class="bottom-left">
<div id="kode-sertifikat">
Kode Sertifikat: <span id="kodeValue">-</span>
</div>
<div class="microtext" id="hashArea"></div>
</div>

</div>

<script>

// ===== GENERATE CERTIFICATE =====
function generateCertificate(){

  var nama = document.getElementById("namaInput").value;
  var sekolah = document.getElementById("sekolahInput").value;

  if(nama=="" || sekolah==""){
    alert("Nama dan Sekolah wajib diisi");
    return;
  }

  document.getElementById("namaPeserta").innerText = nama;
  document.getElementById("namaSekolah").innerText = sekolah;

  document.getElementById("qrcode").innerHTML="";

  var isiQR = "Ditanda tangani secara elektronik oleh Pengawas Pembina SD Kecamatan Rumpin";

  new QRCode(document.getElementById("qrcode"), {
    text: isiQR,
    width:110,
    height:110
  });

  kirimKeServer(nama, sekolah);
}


// ===== JSONP REQUEST =====
function kirimKeServer(nama, sekolah){

  const script = document.createElement("script");

  script.src =
  "https://script.google.com/macros/s/AKfycbwDyfzM0bp1Ux7d-txHrRYqwyHDDAMgwj1UGjK1DswoUvm-4dZUPTfHh3yK7jJYcFIi/exec"
  + "?nama=" + encodeURIComponent(nama)
  + "&sekolah=" + encodeURIComponent(sekolah)
  + "&kodeKegiatan=SA"
  + "&callback=handleResponse";

  document.body.appendChild(script);
}


// ===== HANDLE RESPONSE =====
function handleResponse(response){

  if(response.success){
      document.getElementById("kodeValue").innerText = response.nomor;
      document.getElementById("hashArea").innerText = "Security Hash: " + response.hash;
  } else {
      alert("Gagal menyimpan data");
  }

}

</script>

</body>
</html>
